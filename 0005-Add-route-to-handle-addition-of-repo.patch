From 93099b7e84d0598efab83244b7764f05ff8a0be7 Mon Sep 17 00:00:00 2001
From: Amitt Dosanjh <amitt.dosanjh@gmail.com>
Date: Tue, 9 Aug 2022 23:02:41 -0500
Subject: [PATCH 5/6] Add route to handle addition of repo

---
 server/.gitignore   |  2 ++
 server/index.js     | 21 +++++++++++++++++++++
 server/package.json |  2 ++
 3 files changed, 25 insertions(+)

diff --git a/server/.gitignore b/server/.gitignore
index 0d6877a..9b169a1 100644
--- a/server/.gitignore
+++ b/server/.gitignore
@@ -2,6 +2,8 @@
 coverage/
 node_modules/
 *.log
+.env
+package-lock.json
 
 # OS generated files
 .DS_Store
diff --git a/server/index.js b/server/index.js
index 7f713f7..65bc7b8 100644
--- a/server/index.js
+++ b/server/index.js
@@ -1,6 +1,8 @@
+require("dotenv").config();
 require("./db");
 const express = require("express");
 const path = require("path");
+const axios = require("axios");
 
 const app = express();
 
@@ -9,6 +11,25 @@ const PORT = 8080;
 app.use(express.static(path.join(__dirname, "..", "client", "dist")));
 app.use(express.json());
 
+app.post("/repo/add", (req, res) => {
+  const { username, repo } = req.body;
+  let options = {
+    method: "get",
+    url: `https://api.github.com/repos/${username}/${repo}`,
+    headers: {
+      "User-Agent": "request",
+      Authorization: `token ${process.env.GITHUB_API_TOKEN}`,
+    },
+  };
+  axios(options)
+    .then((response) => {
+      console.log(response.data);
+    })
+    .catch((error) => {
+      console.log(error);
+    });
+});
+
 app.listen(PORT, () => console.log("listening on port " + PORT));
 
 module.exports = app;
diff --git a/server/package.json b/server/package.json
index c01d502..77dc659 100644
--- a/server/package.json
+++ b/server/package.json
@@ -13,6 +13,8 @@
     "nodemon": "^2.0.19"
   },
   "dependencies": {
+    "axios": "^0.27.2",
+    "dotenv": "^16.0.1",
     "express": "^4.18.1",
     "mongoose": "^6.5.1",
     "path": "^0.12.7"
-- 
2.34.1

